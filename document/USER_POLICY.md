# 사용자 관리 정책 초안

버전: 0.1
작성일: 2026-02-09
작성자: 개발팀

목적

- 본 문서는 회원관리(가입, 인증, 권한, 비밀번호 정책 등)에 관한 운영·개발 기준을 정의하여 보안·운영 일관성을 확보하기 위한 초안입니다.

범위

- `User` 엔티티 관련 백엔드/프론트엔드 구현, 운영 절차, 감사 항목을 포함합니다.

1. 역할(그룹) 및 권한

- 역할 목록 및 권한 개요
  - `admin`: 시스템 전체 제어 (사용자·권한 관리, 설정, 데이터 수정)
  - `operator`: 운영·콘텐츠 담당 (기존 `manager` + `editor` 역할 통합). 코스/템플릿/스케줄 생성·수정·운영, 통계 조회 등.
  - `instructor`: 자신이 소유한 코스/강의/일정에 대한 CRUD
  - `viewer`: 읽기 전용
  - `guest`: 제한된 체험/비회원 뷰

- 권한 매핑
  - 모든 MCP 툴은 역할 매트릭스에 따라 호출 허용 여부를 검사합니다.
  - 민감 기능(사용자 역할 변경, 계정 삭제, 시스템 설정 등)은 `admin` 전용으로 제한합니다. `operator`는 운영·콘텐츠 권한을 가지지만 사용자·권한 관리나 영구 삭제 권한은 갖지 않습니다.

### 역할 명칭 한글 매핑 (권장)

표준 enum 값(영문)과 UI/문서 표시용 한글 라벨을 매핑해 두면 운영과 사용자 안내에 유리합니다. 권장 매핑은 다음과 같습니다:

- `admin` → `관리자`
- `operator` → `운영자`
- `instructor` → `강의자`
- `viewer` → `사용자(뷰어)`
- `guest` → `게스트`

설계 지침:

- 데이터베이스 및 코드에서는 영문 `Role` enum을 사용하고, 프론트엔드/문서/로그에서는 한글 라벨을 표기합니다.
- 관리 UI에서는 역할 선택 시 한글 라벨과 함께 영문 값을 보여주어 혼동을 줄이세요(e.g., `운영자 (operator)`).
- 다국어 지원이 필요한 경우 i18n 키(`role.admin`, `role.operator` 등)를 도입하세요.

1. 계정 수명주기

- 가입
  - 유효한 이메일과 비밀번호로 가입.
  - 이메일 검증 토큰 발급(만료 기본 24시간). 이메일 확인 전에는 일부 기능 제한.
- 활성화/비활성화
  - 관리자가 계정을 일시 비활성화할 수 있으며, 비활성화 상태는 모든 인증 토큰 무효화.
- 탈퇴
  - 사용자 요청 시 소프트 삭제(데이터 보존 정책에 따름). 운영 정책에 따라 즉시 영구 삭제 옵션 가능.

1. 비밀번호 정책

- 최소 길이: 8자
- 권장 복잡성: 대문자/소문자/숫자/특수문자 혼합
- 최근 사용한 비밀번호 재사용 방지(최근 3회)
- 비밀번호 해싱: `bcrypt`(권장 rounds: 12 이상)

1. 인증 및 세션

- 토큰
  - Access JWT: 만료 24시간
  - 선택적 Refresh Token: 장기 만료, DB에 해시 저장
- 로그아웃
  - 클라이언트 토큰 제거 및 서버 측 블랙리스트(옵션)
- 로그인 보안
  - 실패 시도 제한(예: 5회), 초과 시 계정 잠금(기본 15분)
  - IP/계정 단위 rate limit 적용

1. 이메일 검증 및 비밀번호 재설정

- 이메일 검증
  - `emailVerificationToken` 발급, 만료 24시간, 사용 후 무효화
- 비밀번호 재설정
  - `passwordResetToken` 발급, 만료 1시간, 토큰 사용 시 즉시 무효화
- 개발 환경: 이메일은 로그(콘솔)로 대체 가능

1. 다중요소 인증(MFA)

- 선택적 기능: TOTP 기반 MFA 지원 권장
- 사용자 프로필: `mfaEnabled`, `mfaSecret` 필드로 관리

1. 역할 변경·승인 플로우

- `instructor` 권한 부여 시 관리자 승인 절차 권장(강사 자격 검증)
- 권한 변경 로그는 감사 목적을 위해 기록

1. 강사 전용 필드 (플래그 기반)

- `isInstructorProfileActive` 같은 플래그로 강사용 추가 필드 활성화
- 활성화 시 표시되는 선택적 필드 예: `affiliation`, `certifications`, `bio`, `avatarUrl`

1. 감사·로깅

- 모든 인증/권한 변경/중요 액션 로그 기록 (누가, 언제, 어떤 변경)
- 로그 보관 정책: 최소 90일(법적 요구사항에 따라 조정)

1. 개인정보·데이터 보존

- 사용자 개인정보(이메일, 이름 등)는 최소 권한원칙에 따라 접근 통제
- 데이터 보존: 탈퇴 후 최소 보존 기간(예: 30일) 후 익명화 또는 삭제

1. API·툴 접근 정책

- MCP 툴별 역할 제약 표준화
- 민감 엔드포인트는 추가 감사 토큰 또는 관리자 승인 필요

1. 운영·배포 참고

- 이메일 서비스: 운영 환경은 SMTP/외부 서비스(SendGrid, SES 등) 사용
- Redis/BullMQ 사용 시 큐 권한 및 연결 정보는 별도 시크릿 관리

1. 리뷰 체크리스트 (검토 시)

- [ ] 역할 목록과 매핑이 충분히 세분화되어 있는가?
- [ ] 가입/인증 흐름에 이메일 검증·토큰 만료 정책이 명시되어 있는가?
- [ ] 비밀번호·MFA 정책이 조직 요구에 부합하는가?
- [ ] 강사 전용 필드 활성화 조건과 승인 프로세스가 명확한가?
- [ ] 로그 보관·감사 체계가 구현 가능하도록 설계되었는가?

---

피드백 요청

- 우선 검토 포인트: 역할(그룹) 정의, 강사 전용 필드 활성화 기준, 이메일/비밀번호 만료 정책
- 수정 제안 주시면 문서 반영 후 `PROGRESS_REPORT.md` 요약에 포함하겠습니다.
